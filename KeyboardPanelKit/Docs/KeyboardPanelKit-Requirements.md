# KeyboardPanelKit 需求文档

## 概述

KeyboardPanelKit 是一个纯 SwiftUI 实现的键盘面板管理框架，用于在 iOS 应用中实现类似微信/iMessage 的输入体验。

## 核心功能

### 1. 键盘管理

- 监听系统键盘的显示/隐藏状态
- 获取键盘的高度和动画参数
- 支持键盘弹出时的平滑动画过渡

### 2. 工具栏 (KeyboardAccessoryView)

键盘顶部显示的工具栏，包含：

| 组件 | 说明 |
|------|------|
| 输入框 | 多行文本输入，支持占位符 |
| 功能按钮区 | 横向滚动的功能按钮列表 |

**工具栏结构：**
```
┌─────────────────────────────────────┐
│ ┌─────────────────┐ ┌───┐ ┌───┐ ┌───┐ │
│ │   输入消息...    │ │😊 │ │⚙️ │ │+  │ │
│ └─────────────────┘ └───┘ └───┘ └───┘ │
└─────────────────────────────────────┘
```

### 3. 功能面板 (Panel)

点击工具栏按钮后，键盘收起，功能面板在键盘位置弹出：

- **面板高度**：与系统键盘高度完全一致
- **动画效果**：跟随键盘动画曲线和时长
- **面板内容**：可自定义（表情面板、更多功能面板等）

**面板切换流程：**
```
键盘显示 → 点击表情按钮 → 键盘收起 + 表情面板弹出
表情面板 → 点击键盘按钮 → 表情面板收起 + 键盘弹出
```
## 技术要点

### 键盘高度同步

- 记录最后一次键盘高度
- 面板弹出时使用记录的键盘高度
- 支持不同输入法的高度差异

### 动画一致性

- 使用系统键盘动画曲线
- 动画时长与键盘同步
- 避免动画跳跃

### 焦点管理

- 点击面板按钮时，收起键盘
- 点击键盘按钮时，输入框获得焦点
- 支持外部触控收起面板

## 依赖要求

- iOS 15.0+
- UIKit 通过Frame和UIView的动画, 精确计算位置
- 支持外部配置功能面板
- 无第三方依赖

